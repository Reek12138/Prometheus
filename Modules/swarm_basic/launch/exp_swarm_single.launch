<launch>
  <!-- ========== STEP [1] 参数设置 ========== -->
  <!-- 本机id设置 -->
  <arg name="mavros_system_id" value="5"/>
  <arg name="swarm_id" value="1"/>
  <!-- 无人机集群数量 -->
	<arg name="swarm_num_uav" default="2"/>
  <!-- 地理围栏 -->
	<arg name="x_min" default="-15.0"/>
	<arg name="x_max" default="15.0"/>
	<arg name="y_min" default="-15.0"/>
	<arg name="y_max" default="15.0"/>
	<arg name="z_min" default="-3.0"/>
	<arg name="z_max" default="5.0"/>
  <!-- swarm_estimator 参数 -->
	<arg name="input_source" default="2"/>
	<!-- swarm_controller 参数 -->
	<arg name="collision_flag" default="0"/>
	<arg name="Takeoff_height" default="1.0"/>
	<arg name="Disarm_height" default="0.2"/>
	<arg name="Land_speed" default="0.2"/>
	<arg name="Land_mode" default="1"/>
  <!-- ========== ========== ========== -->

<group ns="/uav$(arg swarm_id)">

  <!-- ========== STEP [2] 启动 mavros 节点 ========== -->
	<!-- 不同机载电脑,注意修改fcu_url至正确的端口号及波特率 -->
	<node pkg="mavros" type="mavros_node" name="mavros" output="screen">
		<param name="fcu_url" value="/dev/ttyTHS0:921600" />
		<!--param name="gcs_url" value="udp://@192.168.31.46" / -->
		<param name="gcs_url" value="" />
    <!-- 根据 QGC 里面的 MAV_SYS_ID 设置 -->
		<param name="target_system_id" value="$(arg mavros_system_id)" />
		<param name="target_component_id" value="1" />
    <!-- ++++++++++ [PARAMETER] 配置文件 ++++++++++ -->
		<rosparam command="load" file="$(find swarm_basic)/config/experiment_config/px4_pluginlists_gps.yaml" />
    <!-- ++++++++++ [PARAMETER] 配置文件 ++++++++++ -->
		<rosparam command="load" file="$(find swarm_basic)/config/experiment_config/px4_config_gps.yaml" />
	</node>
  <!-- ========== ========== ========== -->

  <!-- ========== STEP [3] 启动 Prometheus 和飞控通信 ========== -->
    <!-- swarm_estimator -->
    <node pkg="prometheus_swarm_control" type="swarm_estimator" name="swarm_estimator" output="screen">
      <param name="uav_id" value="$(arg swarm_id)"/>
      <param name="input_source" value="$(arg input_source)" />
    </node>
    <!-- swarm_controller -->
    <node pkg="prometheus_swarm_control" type="swarm_controller" name="swarm_controller" output="screen">
      <param name="swarm_num_uav" value="$(arg swarm_num_uav)"/>
      <param name="uav_id" value="$(arg swarm_id)"/>
      <param name="collision_flag" value="$(arg collision_flag)"/>
      <param name="Takeoff_height" value="$(arg Takeoff_height)"/>
      <param name="Disarm_height" value="$(arg Disarm_height)"/>
      <param name="Land_speed" value="$(arg Land_speed)"/>
      <param name="Land_mode" value="$(arg Land_mode)"/>
      <param name="geo_fence/x_min" value="$(arg x_min)"/>
      <param name="geo_fence/x_max" value="$(arg x_max)"/>
      <param name="geo_fence/y_min" value="$(arg y_min)"/>
      <param name="geo_fence/y_max" value="$(arg y_max)"/>
      <param name="geo_fence/z_min" value="$(arg z_min)"/>
      <param name="geo_fence/z_max" value="$(arg z_max)"/>
    </node>
  <!-- ========== ========== ========== -->

</group>

	<!-- ========== STEP [4] 启动 2D 激光雷达 和 tf (还没试过，tf有点问题) ========== -->
	<!-- <include file="$(find bluesea2)/launch/amov-50C-3.launch">
  </include> -->

	<!-- <include file="$(find testpkg)/launch/include/tf_transform_gps.launch">
  </include> -->
  <!-- ========== ========== ========== -->

</launch>
